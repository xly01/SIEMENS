<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>西门子SIMATIC HMI选型指南信息图</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #F0F4F8;
        }
        #page-wrapper {
            transition: margin-right 0.4s ease-in-out;
        }
        .gradient-text {
            color: #009999; /* Siemens official logo color */
        }
        .highlight-text {
            color: #009999;
            font-weight: bold;
        }
        .tab-button {
            transition: all 0.3s ease;
            border-bottom: 4px solid transparent;
            padding: 0.75rem 1rem;
            white-space: nowrap;
        }
        .tab-button.active {
            color: #007EA7;
            border-bottom-color: #00A8E8;
            font-weight: 700;
        }
        .tab-button.filtered-out {
            opacity: 0.4;
            pointer-events: none;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        table th {
            background-color: #EBF4F8;
            font-weight: bold;
            text-align: left;
            padding: 0.75rem 1rem;
            width: 30%;
        }
        table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #E0E0E0;
        }
        .order-header-row th, .sub-header-row th {
            background-color: #E0E7FF;
            padding-top: 1rem;
            padding-bottom: 1rem;
        }
        .order-row {
            transition: opacity 0.3s ease;
        }
        .order-row.filtered-out {
            opacity: 0.3;
            background-color: #f8f8f8;
        }
        .order-row td:first-child {
            font-weight: 600;
            padding-left: 2rem;
            vertical-align: top;
            padding-top: 1.25rem;
        }
        .order-row td:last-child {
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        .copy-btn, .compare-btn {
             background-color: #EBF4F8;
             padding: 0.25rem 0.5rem;
             border-radius: 0.25rem;
             transition: all 0.2s;
             border: 1px solid #D1E3F0;
        }
        .copy-btn:hover, .compare-btn:hover {
            background-color: #D1E3F0;
        }
        .compare-btn.added {
             background-color: #28a745;
             color: white;
             border-color: #28a745;
        }
        .param-highlight {
            font-weight: 600;
            color: #005A87;
        }
        .software-table-feature-col {
            font-weight: 600;
            background-color: #F8F9FA;
        }
        .software-table-check {
            color: #28a745;
            font-weight: bold;
            font-size: 1.25rem;
        }
         .software-table-cross {
            color: #dc3545;
            font-weight: bold;
            font-size: 1.25rem;
        }
        #compare-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 350px;
            height: 100%;
            background: white;
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
            transition: right 0.4s ease-in-out;
            z-index: 1001;
            display: flex;
            flex-direction: column;
        }
        #compare-sidebar.visible {
            right: 0;
        }
        body.compare-sidebar-visible #page-wrapper {
            margin-right: 350px;
        }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1002;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal-overlay.visible {
            display: flex;
            opacity: 1;
        }
        .lifecycle-dot {
            height: 12px;
            width: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
            flex-shrink: 0;
        }
        .wizard-step {
            display: none;
        }
        .wizard-step.active {
            display: block;
        }
        .wizard-option {
            transition: all 0.2s;
        }
        .wizard-option.selected {
            border-color: #007EA7;
            background-color: #EBF8FF;
            transform: scale(1.02);
        }
        .doc-link {
            @apply text-blue-600 hover:underline;
        }
        /* NEW Styles for Highlight Wizard */
        .highlight-wizard-btn {
            @apply w-full p-2 text-sm text-center bg-gray-100 rounded-md border border-gray-200 cursor-pointer transition-all hover:bg-blue-100 hover:border-blue-300;
        }
        .highlight-wizard-btn.active {
            @apply bg-blue-600 text-white border-blue-700 font-bold;
        }
        .highlight-result {
            display: none;
            animation: fadeIn 0.5s;
        }
        .highlight-result.show {
            display: block;
        }
    </style>
</head>
<body class="text-[#003459]">
    <div id="page-wrapper">
        <header class="bg-white shadow-md sticky top-0 z-50">
            <div class="container mx-auto px-6 py-4 flex justify-between items-center">
                <h1 class="text-2xl md:text-3xl font-bold gradient-text">SIEMENS</h1>
                <div class="text-sm font-semibold text-[#007EA7]">本工具所示价格为表格价，不包含折扣，下单请联系当地西门子办事处</div>
            </div>
        </header>

        <main class="container mx-auto p-4 md:p-8">

            <section id="intro" class="text-center mb-12">
                <h2 class="text-4xl md:text-5xl font-extrabold mb-4 gradient-text">西门子HMI选型工具</h2>
                <p class="text-lg md:text-xl max-w-3xl mx-auto text-gray-600">本工具非官方，结果仅供参考，谢礼阳 13372509117 SIEMENS HZ OEM 销售</p>
            </section>
            
            <section id="visual-overview" class="mb-12">
                 <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                     <!-- Column 1: Radar Chart -->
                     <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col">
                          <h3 class="text-xl font-bold mb-4 text-center">主流HMI系列能力雷达图</h3>
                          <div class="relative flex-grow h-64 md:h-80">
                              <canvas id="performanceRadarChart"></canvas>
                          </div>
                     </div>
                     <!-- Column 2: NEW Interactive "Highlight Wizard" -->
                     <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col">
                          <h3 class="text-xl font-bold mb-4">亮点选型向导</h3>
                          <p class="text-sm text-gray-500 mb-4">您最核心的诉求是？</p>
                          <div class="grid grid-cols-2 gap-2 mb-4" id="highlight-wizard-buttons">
                                <button class="highlight-wizard-btn" data-target="tech">数字化</button>
                                <button class="highlight-wizard-btn" data-target="cost">极致性价比</button>
                                <button class="highlight-wizard-btn" data-target="stable">成熟稳定与兼容</button>
                                <button class="highlight-wizard-btn" data-target="pc">PC平台的开放性</button>
                          </div>
                          <div id="highlight-wizard-results" class="flex-grow space-y-3 text-sm border-t pt-3">
                                <!-- Results will be injected here by JS -->
                                <p id="highlight-prompt" class="text-center text-gray-400 pt-8">请点击上方您的核心需求</p>
                          </div>
                     </div>
                     <!-- Column 3: Lifecycle & Main Wizard -->
                     <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col justify-center">
                          <h3 class="text-xl font-bold mb-4">生命周期状态图例</h3>
                          <div class="space-y-4 mb-6">
                              <div class="flex items-center"><span class="lifecycle-dot bg-green-500"></span> <div><span class="font-bold">未来主力</span><span class="text-xs text-gray-500 ml-2">Active / Future-proof</span></div></div>
                              <div class="flex items-center"><span class="lifecycle-dot bg-blue-500"></span> <div><span class="font-bold">市场主流</span><span class="text-xs text-gray-500 ml-2">Active / Mainstream</span></div></div>
                              <div class="flex items-center"><span class="lifecycle-dot bg-yellow-500"></span> <div><span class="font-bold">成熟经典</span><span class="text-xs text-gray-500 ml-2">Mature / Classic</span></div></div>
                              <div class="flex items-center"><span class="lifecycle-dot bg-orange-500"></span> <div><span class="font-bold">维护/淘汰阶段</span><span class="text-xs text-gray-500 ml-2">Phase-out</span></div></div>
                          </div>
                          <button id="open-wizard-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors">
                              开启完整选型向导
                          </button>
                     </div>
                 </div>
            </section>

            <section id="filters-section" class="mb-8 p-6 bg-white rounded-xl shadow-lg">
                <h3 class="text-xl font-bold mb-4">技术特性筛选</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <select id="filter-touch" class="filter-control block w-full p-2 border border-gray-300 rounded-md">
                        <option value="all">所有触摸技术</option>
                        <option value="Capacitive">电容式多点触摸</option>
                        <option value="Resistive">电阻式单点触摸</option>
                    </select>
                    <select id="filter-script" class="filter-control block w-full p-2 border border-gray-300 rounded-md">
                        <option value="all">所有脚本支持</option>
                        <option value="JavaScript">JavaScript</option>
                        <option value="VBScript">VBScript</option>
                        <option value="none">不支持</option>
                    </select>
                    <select id="filter-interface" class="filter-control block w-full p-2 border border-gray-300 rounded-md">
                        <option value="all">所有串行/DP接口</option>
                        <option value="serial">支持串行接口</option>
                        <option value="dp">支持PROFIBUS DP</option>
                    </select>
                    <button id="reset-filters" class="col-span-2 md:col-span-1 bg-gray-500 text-white p-2 rounded-md hover:bg-gray-600">重置筛选</button>
                </div>
            </section>

            <section id="series-tabs" class="mb-16">
                <div class="bg-white rounded-xl shadow-lg">
                    <div class="border-b border-gray-200">
                        <nav class="flex flex-wrap -mb-px px-4" aria-label="Tabs" id="tab-buttons">
                            <button class="tab-button active text-gray-600" data-tab="unified-comfort">精智统一 (Unified Comfort)</button>
                            <button class="tab-button text-gray-600" data-tab="unified-basic">精智统一基础 (Unified Basic)</button>
                            <button class="tab-button text-gray-600" data-tab="comfort">精智系列 (Comfort)</button>
                            <button class="tab-button text-gray-600" data-tab="basic">精简系列 (Basic)</button>
                            <button class="tab-button text-gray-600" data-tab="smart-line-plus">精彩增强 (Smart Line Plus)</button>
                            <button class="tab-button text-gray-600" data-tab="smart-line">精彩系列 (Smart Line)</button>
                            <button class="tab-button text-gray-600" data-tab="ipc">工控机 (Panel PC)</button>
                            <button class="tab-button text-gray-600" data-tab="ifp">工业显示器 (IFP)</button>
                            <button class="tab-button text-gray-600" data-tab="software">软件授权</button>
                        </nav>
                    </div>
                    <div id="tab-contents" class="p-6 md:p-8">
                        
                        <div id="unified-comfort" class="tab-content active" data-touch="Capacitive" data-script="JavaScript" data-interface="serial">
                            <div class="flex items-center mb-2">
                               <h3 class="text-2xl font-bold">精智系列舒适型面板 (Unified Comfort Panels)</h3>
                               <div class="flex items-center ml-4 text-sm"><span class="lifecycle-dot bg-green-500"></span>生命周期: 未来主力</div>
                            </div>
                            <p class="text-gray-600 mb-6">作为HMI旗舰，为最严苛的应用而生。它集成了工业边缘计算、多用户远程访问和顶级安全架构，是连接OT与IT世界的强大网关和实现工业4.0的理想平台。</p>
                            <div class="overflow-x-auto">
                                <table class="min-w-full text-sm rounded-lg overflow-hidden">
                                    <thead><tr><th colspan="2">硬件与软件参数</th></tr></thead>
                                    <tbody>
                                        <tr class="order-row"><td>目标应用</td><td>高性能、旗舰级，IT/OT融合，数字化应用</td></tr>
                                        <tr class="order-row"><td>触摸技术</td><td>电容式多点触摸</td></tr>
                                        <tr class="order-row"><td>处理器架构</td><td class="param-highlight">高性能 ARM</td></tr>
                                        <tr class="order-row"><td>PROFINET接口</td><td>1x 千兆 + 1x 10/100Mbit (2端口交换机)</td></tr>
                                        <tr class="order-row"><td>串行接口</td><td>是 (RS422/485)</td></tr>
                                        <tr class="order-row"><td>USB 接口</td><td>4 x USB-A 3.1</td></tr>
                                        <tr class="order-row"><td>SD卡插槽</td><td>2个 (SD/SDHC/SDXC)</td></tr>
                                        <tr class="order-row"><td>工程软件</td><td>WinCC Unified Comfort (TIA Portal)</td></tr>
                                        <tr class="order-row"><td>脚本语言</td><td class="param-highlight">JavaScript</td></tr>
                                        <tr class="order-row"><td>核心优势</td><td><span class="param-highlight">工业边缘集成</span>, 强大的Web客户端远程访问, 顶级安全架构, 矢量图形</td></tr>
                                        <tr class="order-row" data-param="doc-links"><td>官方文档</td><td></td></tr>
                                        <tr class="order-header-row"><th colspan="2">屏幕尺寸、订货号(MLFB)与价格信息</th></tr>
                                    </tbody>
                                    <tbody class="order-number-body"></tbody>
                                    <tbody class="accessories-body"></tbody>
                                </table>
                            </div>
                        </div>

                        <div id="unified-basic" class="tab-content" data-touch="Capacitive" data-script="JavaScript" data-interface="none">
                            <div class="flex items-center mb-2">
                                <h3 class="text-2xl font-bold">精智系列基本型面板 (Unified Basic Panels)</h3>
                                <div class="flex items-center ml-4 text-sm"><span class="lifecycle-dot bg-green-500"></span>生命周期: 未来主力</div>
                            </div>
                            <p class="text-gray-600 mb-6">新一代入门级标杆，将现代Web技术带入基础应用市场。拥有多点触控、JS脚本和免费Web客户端等革命性功能，为成本敏感型项目注入前所未有的强大能力。</p>
                             <div class="overflow-x-auto">
                                <table class="min-w-full text-sm rounded-lg overflow-hidden">
                                    <thead><tr><th colspan="2">硬件与软件参数</th></tr></thead>
                                    <tbody>
                                        <tr class="order-row"><td>目标应用</td><td>新一代基础型，对标传统精简面板，但功能更强大</td></tr>
                                        <tr class="order-row"><td>触摸技术</td><td>电容式多点触摸</td></tr>
                                        <tr class="order-row"><td>处理器架构</td><td class="param-highlight">ARM</td></tr>
                                        <tr class="order-row"><td>PROFINET接口</td><td>2个端口 (集成交换机)</td></tr>
                                        <tr class="order-row"><td>USB 接口</td><td>4 x USB-A</td></tr>
                                        <tr class="order-row"><td>SD卡插槽</td><td>2个 (SD/SDHC/SDXC)</td></tr>
                                        <tr class="order-row"><td>工程软件</td><td>WinCC Unified Basic (TIA Portal)</td></tr>
                                        <tr class="order-row"><td>脚本语言</td><td class="param-highlight">JavaScript</td></tr>
                                        <tr class="order-row"><td>核心优势</td><td><span class="param-highlight">集成Web客户端</span>, JavaScript支持, 多点触控, 性能远超经典精简系列</td></tr>
                                        <tr class="order-row" data-param="doc-links"><td>官方文档</td><td></td></tr>
                                        <tr class="order-header-row"><th colspan="2">屏幕尺寸、订货号(MLFB)与价格信息</th></tr>
                                    </tbody>
                                    <tbody class="order-number-body"></tbody>
                                    <tbody class="accessories-body"></tbody>
                                </table>
                            </div>
                        </div>

                        <div id="smart-line-plus" class="tab-content" data-touch="Resistive" data-script="JavaScript" data-interface="serial">
                            <div class="flex items-center mb-2">
                               <h3 class="text-2xl font-bold">精彩增强系列面板 (Smart Line Plus)</h3>
                               <div class="flex items-center ml-4 text-sm"><span class="lifecycle-dot bg-blue-500"></span>生命周期: 市场主流</div>
                            </div>
                            <p class="text-gray-600 mb-6">精彩系列的增强版，在保留原有高性价比和IoT功能的同时，增加了对S7-1200/1500 PLC的直连支持，为TIA博途用户提供了全新的经济型选择。</p>
                             <div class="overflow-x-auto">
                                <table class="min-w-full text-sm rounded-lg overflow-hidden">
                                    <thead><tr><th colspan="2">硬件与软件参数</th></tr></thead>
                                    <tbody>
                                        <tr class="order-row"><td>目标应用</td><td>连接S7-1200/1500的高性价比项目，或传统的S7-200 SMART项目</td></tr>
                                        <tr class="order-row"><td>触摸技术</td><td>模拟电阻式触摸</td></tr>
                                        <tr class="order-row"><td>处理器架构</td><td class="param-highlight">ARM 双核 1.2GHz</td></tr>
                                        <tr class="order-row"><td>内存</td><td>30 MB (项目) / 256 MB (DDR3)</td></tr>
                                        <tr class="order-row"><td>以太网接口</td><td>1个端口 (10/100 Mbit/s)</td></tr>
                                        <tr class="order-row"><td>串行接口</td><td>是 (RS422/485/232)</td></tr>
                                        <tr class="order-row"><td>USB 接口</td><td>1 x USB-A 2.0</td></tr>
                                        <tr class="order-row"><td>SD卡插槽</td><td>1个 (Micro SD)</td></tr>
                                        <tr class="order-row"><td>工程软件</td><td>WinCC flexible SMART V5 SP1</td></tr>
                                        <tr class="order-row"><td>脚本语言</td><td class="param-highlight">JavaScript</td></tr>
                                        <tr class="order-row"><td>核心优势</td>
                                            <td>
                                                <ul class="list-disc list-inside space-y-1">
                                                    <li class="param-highlight">支持 S7-1200/1500 (S7 Plus Communication)，支持符号寻址</li>
                                                    <li class="param-highlight">支持 S7-1200/1500 (S7 PUT/GET Communication)，仅支持绝对地址寻址</li>
                                                    <li class="param-highlight">支持导入博途工程文件中的PLC变量</li>
                                                    <li class="param-highlight">支持把数据记录存储到HMI设备内存</li>
                                                    <li>增强的MODBUS TCP/IP驱动</li>
                                                </ul>
                                            </td>
                                        </tr>
                                        <tr class="order-row" data-param="doc-links"><td>官方文档</td><td></td></tr>
                                        <tr class="order-header-row"><th colspan="2">屏幕尺寸、订货号(MLFB)与价格信息</th></tr>
                                    </tbody>
                                    <tbody class="order-number-body"></tbody>
                                    <tbody class="accessories-body"></tbody>
                                </table>
                            </div>
                        </div>

                        <div id="smart-line" class="tab-content" data-touch="Resistive" data-script="JavaScript" data-interface="serial">
                            <div class="flex items-center mb-2">
                               <h3 class="text-2xl font-bold">精彩系列面板 (Smart Line V5)</h3>
                               <div class="flex items-center ml-4 text-sm"><span class="lifecycle-dot bg-blue-500"></span>生命周期: 市场主流</div>
                            </div>
                            <p class="text-gray-600 mb-6">专为S7-200 SMART生态或独立应用打造的极致性价比之选。采用独立软件，提供强大的硬件、现代JS脚本和创新的IoT连接能力，是特定市场的经济型利器。</p>
                             <div class="overflow-x-auto">
                                <table class="min-w-full text-sm rounded-lg overflow-hidden">
                                    <thead><tr><th colspan="2">硬件与软件参数</th></tr></thead>
                                    <tbody>
                                        <tr class="order-row"><td>目标应用</td><td>S7-200 SMART配套，极致性价比，灵活的第三方PLC连接</td></tr>
                                        <tr class="order-row"><td>触摸技术</td><td>模拟电阻式触摸</td></tr>
                                        <tr class="order-row"><td>处理器架构</td><td class="param-highlight">ARM 双核 1.2GHz</td></tr>
                                        <tr class="order-row"><td>内存</td><td>20 MB (项目) / 256 MB (DDR3)</td></tr>
                                        <tr class="order-row"><td>以太网接口</td><td>1个端口 (10/100 Mbit/s)</td></tr>
                                        <tr class="order-row"><td>串行接口</td><td>是 (RS422/485/232)</td></tr>
                                        <tr class="order-row"><td>USB 接口</td><td>1 x USB-A 2.0</td></tr>
                                        <tr class="order-row"><td>SD卡插槽</td><td>1个 (Micro SD)</td></tr>
                                        <tr class="order-row"><td>工程软件</td><td>WinCC flexible SMART V5</td></tr>
                                        <tr class="order-row"><td>脚本语言</td><td class="param-highlight">JavaScript</td></tr>
                                        <tr class="order-row"><td>核心优势</td><td><span class="param-highlight">可扩展IoT模块 (4G/Wi-Fi)</span>, 性价比极高, 与200SMART完美配合</td></tr>
                                        <tr class="order-row" data-param="doc-links"><td>官方文档</td><td></td></tr>
                                        <tr class="order-header-row"><th colspan="2">屏幕尺寸、订货号(MLFB)与价格信息</th></tr>
                                    </tbody>
                                    <tbody class="order-number-body"></tbody>
                                    <tbody class="accessories-body"></tbody>
                                </table>
                            </div>
                        </div>
                        
                        <div id="comfort" class="tab-content" data-touch="Resistive" data-script="VBScript" data-interface="serial dp">
                            <div class="flex items-center mb-2">
                                <h3 class="text-2xl font-bold">精智系列面板 (Comfort Panels)</h3>
                                <div class="flex items-center ml-4 text-sm"><span class="lifecycle-dot bg-orange-500"></span>生命周期: 维护/淘汰阶段</div>
                            </div>
                            <p class="text-gray-600 mb-6">曾经的高性能行业标杆，技术成熟，应用广泛。现已进入生命周期后期（大尺寸已宣布淘汰），主要用于现有系统的维护、备件替换或基于VBScript的旧项目扩展。</p>
                            <div class="overflow-x-auto">
                               <table class="min-w-full text-sm rounded-lg overflow-hidden">
                                    <thead><tr><th colspan="2">硬件与软件参数</th></tr></thead>
                                    <tbody>
                                        <tr class="order-row"><td>目标应用</td><td>(旧) 高性能应用, 现主要用于系统维护和扩展</td></tr>
                                        <tr class="order-row"><td>触摸技术</td><td>电阻式单点触摸</td></tr>
                                        <tr class="order-row"><td>处理器架构</td><td class="param-highlight">x86 (7"及以上)</td></tr>
                                        <tr class="order-row"><td>内存</td><td>4 MB 至 24 MB</td></tr>
                                        <tr class="order-row"><td>PROFINET接口</td><td>2个端口 (集成交换机)</td></tr>
                                        <tr class="order-row"><td>PROFIBUS DP接口</td><td>是 (标配)</td></tr>
                                        <tr class="order-row"><td>USB 接口</td><td>2 x USB-A, 1 x USB-miniB</td></tr>
                                        <tr class="order-row"><td>SD卡插槽</td><td>2个</td></tr>
                                        <tr class="order-row"><td>工程软件</td><td>WinCC Comfort (TIA Portal)</td></tr>
                                        <tr class="order-row"><td>脚本语言</td><td class="param-highlight">VBScript</td></tr>
                                        <tr class="order-row"><td>核心优势</td><td><span class="param-highlight">集成系统诊断</span>, 功能全面且稳定, 支持PROFIBUS DP</td></tr>
                                        <tr class="order-row" data-param="doc-links"><td>官方文档</td><td></td></tr>
                                        <tr class="order-header-row"><th colspan="2">屏幕尺寸、订货号(MLFB)与价格信息</th></tr>
                                    </tbody>
                                    <tbody class="order-number-body"></tbody>
                                    <tbody class="accessories-body"></tbody>
                                </table>
                            </div>
                        </div>

                        <div id="basic" class="tab-content" data-touch="Resistive" data-script="none" data-interface="dp">
                            <div class="flex items-center mb-2">
                                <h3 class="text-2xl font-bold">精简系列面板 (Basic Panels 2nd Gen)</h3>
                                <div class="flex items-center ml-4 text-sm"><span class="lifecycle-dot bg-yellow-500"></span>生命周期: 成熟经典</div>
                            </div>
                            <p class="text-gray-600 mb-6">久经考验的入门级解决方案，为简单、成本极度敏感的应用提供最经济可靠的可视化功能。配备触摸屏和实体按键，是标准任务的经典执行者。</p>
                            <div class="overflow-x-auto">
                               <table class="min-w-full text-sm rounded-lg overflow-hidden">
                                    <thead><tr><th colspan="2">硬件与软件参数</th></tr></thead>
                                    <tbody>
                                        <tr class="order-row"><td>目标应用</td><td>基础型/入门级，成本敏感的标准任务</td></tr>
                                        <tr class="order-row"><td>触摸技术</td><td>电阻式单点触摸</td></tr>
                                        <tr class="order-row"><td>处理器架构</td><td class="param-highlight">ARM</td></tr>
                                        <tr class="order-row"><td>内存</td><td>10 MB</td></tr>
                                        <tr class="order-row"><td>PROFINET/DP接口</td><td>PN或DP版本可选 (1个端口)</td></tr>
                                        <tr class="order-row"><td>USB 接口</td><td>1 x USB-A</td></tr>
                                        <tr class="order-row"><td>SD卡插槽</td><td>否</td></tr>
                                        <tr class="order-row"><td>工程软件</td><td>WinCC Basic (TIA Portal)</td></tr>
                                        <tr class="order-row"><td>脚本语言</td><td class="param-highlight">不支持</td></tr>
                                        <tr class="order-row"><td>核心优势</td><td><span class="param-highlight">成本极低</span>, 触摸+按键组合操作, 技术成熟稳定</td></tr>
                                        <tr class="order-row" data-param="doc-links"><td>官方文档</td><td></td></tr>
                                        <tr class="order-header-row"><th colspan="2">屏幕尺寸、订货号(MLFB)与价格信息</th></tr>
                                    </tbody>
                                    <tbody class="order-number-body"></tbody>
                                    <tbody class="accessories-body"></tbody>
                                </table>
                            </div>
                        </div>

                        <div id="ipc" class="tab-content" data-touch="Resistive" data-script="all" data-interface="serial">
                            <div class="flex items-center mb-2">
                                <h3 class="text-2xl font-bold">工控机 (Panel PC): SIMATIC IPC377G 系列</h3>
                                <div class="flex items-center ml-4 text-sm"><span class="lifecycle-dot bg-blue-500"></span>生命周期: 市场主流</div>
                            </div>
                            <p class="text-gray-600 mb-6">一体化工控机，将计算单元 (CPU, 内存, 存储) 和触摸屏融合在单一外壳中。它是一个完整的、基于PC的、即装即用的解决方案，非常适合空间有限、需要紧凑型独立工作站的应用场景。</p>
                            <div class="overflow-x-auto">
                               <table class="min-w-full text-sm rounded-lg overflow-hidden">
                                    <thead><tr><th colspan="2">硬件与软件参数</th></tr></thead>
                                    <tbody>
                                        <tr class="order-row"><td>核心架构</td><td class="param-highlight">一体化工控机 (Panel PC)</td></tr>
                                        <tr class="order-row"><td>目标应用</td><td>基于PC的、成本优化的HMI、数据采集或简单控制任务</td></tr>
                                        <tr class="order-row"><td>处理器</td><td>Intel Atom x6413E (四核, 最高3.0 GHz)</td></tr>
                                        <tr class="order-row"><td>内存</td><td>4 / 8 / 16 GB DDR4</td></tr>
                                        <tr class="order-row"><td>存储</td><td>256 / 512 GB M.2 SSD</td></tr>
                                        <tr class="order-row"><td>操作系统</td><td>可选 Windows 10 IoT Enterprise 2019 LTSC</td></tr>
                                        <tr class="order-row"><td>以太网接口</td><td>2 x Gbit LAN (RJ45)</td></tr>
                                        <tr class="order-row"><td>USB 接口</td><td>4 x USB 3.1</td></tr>
                                        <tr class="order-row"><td>串行接口</td><td>4 x COM (2x RS232/485/422, 2x RS232)</td></tr>
                                        <tr class="order-row"><td>视频输出</td><td>2 x DisplayPort</td></tr>
                                        <tr class="order-row"><td>核心优势</td><td><span class="param-highlight">高集成度</span>, 丰富的PC标准接口, 开放的Windows平台</td></tr>
                                        <tr class="order-row" data-param="doc-links"><td>官方文档</td><td></td></tr>
                                        <tr class="order-header-row"><th colspan="2">屏幕尺寸、订货号(MLFB)与价格信息</th></tr>
                                    </tbody>
                                    <tbody class="order-number-body"></tbody>
                                    <tbody class="accessories-body"></tbody>
                               </table>
                            </div>
                        </div>
                        
                        <div id="ifp" class="tab-content" data-touch="Resistive" data-script="all" data-interface="none">
                             <div class="flex items-center mb-2">
                                 <h3 class="text-2xl font-bold">工业显示器 (IFP): SIMATIC IFP Basic 系列</h3>
                                 <div class="flex items-center ml-4 text-sm"><span class="lifecycle-dot bg-blue-500"></span>生命周期: 市场主流</div>
                             </div>
                            <p class="text-gray-600 mb-6">专用的工业级触摸显示器，本身不具备计算能力，必须与一台独立的工控机 (IPC) 或服务器配合使用。适用于计算单元和显示单元需要分开安装的分布式系统架构。</p>
                            <div class="overflow-x-auto">
                               <table class="min-w-full text-sm rounded-lg overflow-hidden">
                                    <thead><tr><th colspan="2">硬件与软件参数</th></tr></thead>
                                    <tbody>
                                        <tr class="order-row"><td>核心架构</td><td class="param-highlight">工业触摸显示器 (Monitor)</td></tr>
                                        <tr class="order-row"><td>目标应用</td><td>分布式系统，计算单元需置于控制柜，显示单元在现场</td></tr>
                                        <tr class="order-row"><td>触摸技术</td><td>模拟电阻式单点触摸</td></tr>
                                        <tr class="order-row"><td>视频接口</td><td>1 x DisplayPort, 1 x VGA</td></tr>
                                        <tr class="order-row"><td>USB 集线器</td><td>1x 上行 (to PC), 2x 下行 (for Peripherals)</td></tr>
                                        <tr class="order-row"><td>电源</td><td>24V DC</td></tr>
                                        <tr class="order-row"><td>前面板防护</td><td>IP65</td></tr>
                                        <tr class="order-row"><td>核心优势</td><td><span class="param-highlight">架构灵活</span>, 性能可扩展 (取决于所连PC), 维护便捷</td></tr>
                                        <tr class="order-row" data-param="doc-links"><td>官方文档</td><td></td></tr>
                                        <tr class="order-header-row"><th colspan="2">屏幕尺寸、订货号(MLFB)与价格信息</th></tr>
                                    </tbody>
                                    <tbody class="order-number-body"></tbody>
                                    <tbody class="accessories-body"></tbody>
                               </table>
                            </div>
                        </div>
                        
                        <div id="software" class="tab-content">
                            <h3 class="text-2xl font-bold mb-2">TIA Portal WinCC 工程软件授权对比</h3>
                            <p class="text-gray-600 mb-6">为不同的HMI硬件和应用复杂度选择正确的工程软件授权至关重要。以下是TIA Portal中各主要WinCC版本的功能对比，帮助您做出明智决策。</p>
                            <div class="overflow-x-auto">
                                <table class="min-w-full text-sm rounded-lg overflow-hidden text-center table-fixed">
                                    <thead class="bg-gray-100">
                                        <tr>
                                            <th class="text-left software-table-feature-col w-[30%]">功能特性</th>
                                            <th class="w-[17.5%]">WinCC Basic</th>
                                            <th class="w-[17.5%]">WinCC Comfort</th>
                                            <th class="w-[17.5%]">WinCC Advanced</th>
                                            <th class="w-[17.5%]">WinCC Unified PC</th>
                                        </tr>
                                    </thead>
                                    <tbody id="software-license-body">
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>
                </div>
            </section>
        </main>

    <div id="compare-sidebar">
        <div class="p-4 border-b">
            <h3 class="text-lg font-bold">对比列表 (<span id="compare-count">0</span>/4)</h3>
        </div>
        <div id="compare-list" class="flex-grow p-4 space-y-2 overflow-y-auto">
            <p class="text-gray-500 text-sm">请从表格中添加产品进行对比。</p>
        </div>
        <div class="p-4 border-t bg-gray-50">
            <button id="start-compare-btn" class="w-full bg-blue-500 text-white p-2 rounded-md hover:bg-blue-600 disabled:bg-gray-300">开始对比</button>
            <button id="clear-compare-btn" class="w-full mt-2 bg-gray-200 text-gray-700 p-2 rounded-md hover:bg-gray-300">清空列表</button>
        </div>
    </div>

    <div id="compare-modal" class="modal-overlay">
        <div class="bg-white rounded-lg shadow-xl m-4 w-full max-w-6xl max-h-[90vh] flex flex-col">
            <div class="p-4 border-b flex justify-between items-center">
                <h2 class="text-xl font-bold">产品对比</h2>
                <button id="close-compare-modal" class="text-2xl">&times;</button>
            </div>
            <div id="compare-table-container" class="p-4 overflow-auto"></div>
        </div>
    </div>

    <div id="wizard-modal" class="modal-overlay">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl">
            <div class="p-4 border-b flex justify-between items-center">
                 <h2 class="text-xl font-bold">智能选型向导</h2>
                 <button id="close-wizard-modal" class="text-2xl">&times;</button>
            </div>
            <div class="p-8">
                <div id="wizard-step-1" class="wizard-step active">
                    <h3 class="text-lg font-semibold mb-1">第1步：您的核心平台与生态系统是？</h3>
                    <p class="text-sm text-gray-500 mb-4">这将决定最基础的技术路线。</p>
                    <div class="space-y-3" id="wizard-q1">
                        <div class="wizard-option border-2 border-gray-200 p-4 rounded-lg cursor-pointer" data-value="tia">
                            <h4 class="font-bold">TIA博途生态 (S7-1200/1500)</h4>
                            <p class="text-sm">我的项目基于TIA博途，追求控制器与HMI的无缝集成。</p>
                        </div>
                        <div class="wizard-option border-2 border-gray-200 p-4 rounded-lg cursor-pointer" data-value="smart">
                             <h4 class="font-bold">S7-200 SMART 或独立应用</h4>
                            <p class="text-sm">我的核心是S7-200 SMART，或追求极致性价比。</p>
                        </div>
                        <div class="wizard-option border-2 border-gray-200 p-4 rounded-lg cursor-pointer" data-value="pc">
                            <h4 class="font-bold">基于PC的开放平台</h4>
                            <p class="text-sm">我需要在设备上运行Windows应用或上位机软件。</p>
                        </div>
                    </div>
                </div>
                <div id="wizard-step-2" class="wizard-step">
                    <h3 class="text-lg font-semibold mb-1">第2步：您的应用复杂度如何？</h3>
                     <p class="text-sm text-gray-500 mb-4">这有助于区分基础型和高性能产品。</p>
                    <div class="space-y-3" id="wizard-q2">
                        <div class="wizard-option border-2 border-gray-200 p-4 rounded-lg cursor-pointer" data-value="simple">
                            <h4 class="font-bold">基础监控与操作</h4>
                            <p class="text-sm">主要用于状态显示、按钮操作、参数设置，无需复杂脚本。</p>
                        </div>
                         <div class="wizard-option border-2 border-gray-200 p-4 rounded-lg cursor-pointer" data-value="complex">
                            <h4 class="font-bold">复杂逻辑与数据处理</h4>
                            <p class="text-sm">需要运行脚本 (VBS/JS)、高级归档、与IT系统交互等。</p>
                        </div>
                    </div>
                </div>
                 <div id="wizard-step-3" class="wizard-step">
                    <h3 class="text-lg font-semibold mb-1">第3步：您的项目优先考虑？</h3>
                    <p class="text-sm text-gray-500 mb-4">这是在相似产品间做选择的关键。</p>
                    <div class="space-y-3" id="wizard-q3">
                        <div class="wizard-option border-2 border-gray-200 p-4 rounded-lg cursor-pointer" data-value="cost">
                            <h4 class="font-bold">成本效益与成熟稳定</h4>
                            <p class="text-sm">我需要一个久经市场考验、成本最低的解决方案。</p>
                        </div>
                         <div class="wizard-option border-2 border-gray-200 p-4 rounded-lg cursor-pointer" data-value="future">
                            <h4 class="font-bold">性能与未来投资保护</h4>
                            <p class="text-sm">我希望采用最新技术，为未来的功能扩展和系统集成做准备。</p>
                        </div>
                    </div>
                </div>
                <div id="wizard-step-4" class="wizard-step text-center">
                     <h3 class="text-lg font-semibold mb-2">推荐结果</h3>
                     <div class="bg-blue-50 p-6 rounded-lg">
                        <p class="text-gray-600">根据您的选择，我们为您推荐：</p>
                        <p id="wizard-recommendation" class="text-2xl font-bold gradient-text my-3"></p>
                        <button id="wizard-view-result" class="w-full bg-green-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-600">查看推荐</button>
                     </div>
                </div>
                <div class="mt-6 flex justify-between">
                    <button id="wizard-prev" class="bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 disabled:opacity-50" disabled>上一步</button>
                    <button id="wizard-next" class="bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 disabled:opacity-50" disabled>下一步</button>
                </div>
            </div>
        </div>
    </div>


    <footer class="bg-[#003459] text-white mt-16 py-6">
        <div class="container mx-auto text-center text-sm">
            <p>本工具持续更新 V1.0版本</p>
            <p>联系人邮箱：540955330@qq.com</p>
            <p>谢礼阳 13372509117 版权所有 2025年7月</p>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const productData = {
                'unified-comfort': {
                    main: [
                        { size: '7"', models: [{ desc: '标准', number: '6AV2128-3GB06-0AX0', price: '洽询' }] },
                        { size: '10.1"', models: [{ desc: '标准', number: '6AV2128-3KB06-0AX0', price: '洽询' }] },
                        { size: '12.1"', models: [{ desc: '标准', number: '6AV2128-3MB06-0AX0', price: '洽询' }] },
                        { size: '15.6"', models: [{ desc: '标准', number: '6AV2128-3QB06-0AX0', price: '洽询' }] },
                        { size: '18.5"', models: [{ desc: '标准', number: '6AV2128-3SB06-0AX0', price: '洽询' }] },
                        { size: '21.5"', models: [{ desc: '标准', number: '6AV2128-3UB06-0AX0', price: '洽询' }] },
                        { size: '专用型号', models: [
                            { desc: '7" PRO (IP65) <br><span class="text-xs font-normal text-gray-500">全方位IP65防护，用于支撑臂/底座安装</span>', number: '6AV2128-3GB06-0AX1', price: '¥ 23,000' },
                            { desc: '10.1" PRO (IP65) <br><span class="text-xs font-normal text-gray-500">全方位IP65防护，用于支撑臂/底座安装</span>', number: '6AV2128-3KB06-0AX1', price: '¥ 33,500' },
                            { desc: '12.1" PRO (IP65) <br><span class="text-xs font-normal text-gray-500">全方位IP65防护，用于支撑臂/底座安装</span>', number: '6AV2128-3MB06-0AX1', price: '¥ 42,900' },
                            { desc: '7" Hygienic (IP69) <br><span class="text-xs font-normal text-gray-500">不锈钢面板，适用于食品/制药等卫生行业</span>', number: '6AV2128-3GB36-0AX1', price: '¥ 29,100' },
                            { desc: '10.1" Hygienic (IP69) <br><span class="text-xs font-normal text-gray-500">不锈钢面板，适用于食品/制药等卫生行业</span>', number: '6AV2128-3KB36-0AX1', price: '¥ 44,600' },
                            { desc: '12.1" Hygienic (IP69) <br><span class="text-xs font-normal text-gray-500">不锈钢面板，适用于食品/制药等卫生行业</span>', number: '6AV2128-3MB36-0AX1', price: '¥ 58,100' },
                        ] }
                    ],
                    accessories: [
                         { size: '存储卡', models: [{ desc: 'SIMATIC 2GB', number: '6AV2181-8XP00-0AX0', price: '¥ 1,500' }] },
                         { size: '保护膜', models: [{ desc: '适用于对应尺寸', number: '6AV2124-6....', price: '洽询' }] }
                    ]
                },
                'unified-basic': {
                    main: [
                        { size: '4.3"', models: [{ desc: '', number: '6AV2125-2DB20-0AX0', price: '¥ 4,330' }] },
                        { size: '7"', models: [{ desc: '', number: '6AV2125-2GB20-0AX0', price: '¥ 7,490' }] },
                        { size: '10.1"', models: [{ desc: '', number: '6AV2125-2KB20-0AX0', price: '¥ 12,900' }] },
                        { size: '12.1"', models: [{ desc: '', number: '6AV2125-2MB20-0AX0', price: '¥ 18,100' }] },
                    ],
                    accessories: [
                         { size: '存储卡', models: [{ desc: 'SIMATIC 2GB', number: '6AV2181-8XP00-0AX0', price: '¥ 1,500' }] },
                         { size: '保护膜', models: [{ desc: '适用于对应尺寸', number: '6AV2125-6....', price: '洽询' }] }
                    ]
                },
                 'smart-line-plus': {
                    main: [
                        { size: '7"', models: [{ desc: '', number: '6AV6648-2AC11-3AX0', price: '洽询' }] },
                        { size: '10.1"', models: [{ desc: '', number: '6AV6648-2AE11-3AX0', price: '洽询' }] },
                    ],
                    accessories: [
                        { size: '扩展模块', models: [
                            { desc: 'IoT模块 (WIFI)', number: '6AV6648-1CM01-3AX0', price: '¥ 497.37' },
                            { desc: 'IoT模块 (4G)', number: '6AV6648-1CM11-3AX0', price: '¥ 718.43' }
                        ] }
                    ]
                },
                'smart-line': {
                    main: [
                        { size: '7"', models: [{ desc: '', number: '6AV6648-0CC51-3AX0', price: '¥ 2,800' }] },
                        { size: '10.1"', models: [{ desc: '', number: '6AV6648-0CE51-3AX0', price: '¥ 4,800' }] },
                    ],
                    accessories: [
                        { size: '扩展模块', models: [
                            { desc: 'IoT模块 (WIFI)', number: '6AV6648-1CM01-3AX0', price: '¥ 497.37' },
                            { desc: 'IoT模块 (4G)', number: '6AV6648-1CM11-3AX0', price: '¥ 718.43' }
                        ] }
                    ]
                },
                'comfort': {
                    main: [
                        { size: '4"', models: [{ desc: 'KTP400', number: '6AV2124-2DC01-0AX1', price: '¥ 4,330' }] },
                        { size: '7"', models: [{ desc: 'TP700', number: '6AV2124-0GC01-0AX0', price: '¥ 11,200' }, { desc: 'KP700', number: '6AV2124-1GC01-0AX0', price: '¥ 11,200' }] },
                        { size: '9"', models: [{ desc: 'TP900', number: '6AV2124-0JC01-0AX0', price: '¥ 16,300' }, { desc: 'KP900', number: '6AV2124-1JC01-0AX0', price: '¥ 16,300' }] },
                        { size: '12"', models: [{ desc: 'TP1200', number: '6AV2124-0MC01-0AX0', price: '¥ 23,000' }, { desc: 'KP1200', number: '6AV2124-1MC01-0AX0', price: '¥ 23,000' }] },
                        { size: '15"', models: [{ desc: 'TP1500', number: '6AV2124-0QC02-0AX1', price: '¥ 37,200' }] },
                        { size: '19"', models: [{ desc: 'TP1900', number: '6AV2124-0UC02-0AX1', price: '¥ 52,600' }] },
                        { size: '22"', models: [{ desc: 'TP2200', number: '6AV2124-0XC02-0AX1', price: '¥ 68,000' }] },
                        { size: '专用型号', models: [
                            { desc: '7" Outdoor', number: '6AV2124-0GC13-0AX0', price: '¥ 22,200' },
                            { desc: '15" Outdoor', number: '6AV2124-0QC13-0AX0', price: '¥ 54,900' },
                            { desc: 'KTP400F Mobile', number: '6AV2124-2DC11-0AX0', price: '洽询' },
                            { desc: 'KTP700F Mobile', number: '6AV2124-2GC11-0AX0', price: '洽询' },
                            { desc: 'KTP900F Mobile', number: '6AV2124-2JC11-0AX0', price: '洽询' },
                        ] }
                    ],
                    accessories: [
                        { size: '存储卡', models: [{ desc: 'SIMATIC 2GB', number: '6AV2181-8XP00-0AX0', price: '¥ 1,500' }] },
                        { size: '保护膜', models: [{ desc: '适用于对应尺寸', number: '6AV2124-6....', price: '洽询' }] }
                    ]
                },
                'basic': {
                    main: [
                        { size: '4"', models: [{ desc: 'PN', number: '6AV2123-2DB03-0AX0', price: '¥ 2,930' }] },
                        { size: '7"', models: [{ desc: 'PN', number: '6AV2123-2GB03-0AX0', price: '¥ 4,680' }, { desc: 'DP', number: '6AV2123-2GA03-0AX0', price: '¥ 4,900' }] },
                        { size: '9"', models: [{ desc: 'PN', 'number': '6AV2123-2JB03-0AX0', price: '¥ 7,370' }] },
                        { size: '12"', models: [{ desc: 'PN', number: '6AV2123-2MB03-0AX0', price: '¥ 11,600' }, { desc: 'DP', number: '6AV2123-2MA03-0AX0', price: '¥ 11,900' }] },
                    ],
                     accessories: [
                        { size: '保护膜', models: [{ desc: '适用于对应尺寸', number: '6AV2123-6....', price: '洽询' }] }
                    ]
                },
                'ipc': {
                    main: [
                        { size: '12"', models: [{ desc: '4GB/256GB/Win10', number: '6AV7231-0CC21-2BA0', price: '洽询' }] },
                        { size: '15"', models: [{ desc: '4GB/256GB/Win10', number: '6AV7231-0DC21-2BA0', price: '洽询' }] },
                        { size: '19"', models: [{ desc: '4GB/256GB/Win10', number: '6AV7231-0EC21-2BA0', price: '洽询' }] },
                        { size: '22"', models: [{ desc: '4GB/256GB/Win10', number: '6AV7231-0FC21-2BA0', price: '洽询' }] }
                    ],
                    accessories: []
                },
                'ifp': {
                    main: [
                        { size: '12"', models: [{ desc: '标准', number: '6AV7862-2BC00-0AA0', price: '洽询' }, { desc: 'Covered (IP65)', number: '6AV7862-2BC10-0AA0', price: '洽询' }] },
                        { size: '15"', models: [{ desc: '标准', number: '6AV7862-2BD00-0AA0', price: '洽询' }] },
                        { size: '19"', models: [{ desc: '标准', number: '6AV7862-2BE00-0AA0', price: '洽询' }] },
                        { size: '22"', models: [{ desc: '标准', number: '6AV7862-2BF00-0AA0', price: '洽询' }] }
                    ],
                    accessories: []
                }
            };

            const docLinks = {
                'unified-comfort': [
                    { name: 'WinCC Unified 入门指南', url: 'https://support.industry.siemens.com/dl/dl-media/244/109954244/att_1263983/v1/177545453067_zh-CHS/zh-CHS/index.html#treeId=f637aa78ec078a476b3ad61d90d48b04' },
                    { name: 'Unified 精智面板映像下载', url: 'https://support.industry.siemens.com/cs/document/109825605/simatic-hmi-%E6%93%8D%E4%BD%9C%E9%9D%A2%E6%9D%BF%E7%9A%84%E6%98%A0%E5%83%8F%E4%B8%8B%E8%BD%BD%E9%A1%B9%EF%BC%9Aunified-%E7%B2%BE%E6%99%BA%E9%9D%A2%E6%9D%BF?dti=0&lc=zh-CN' },
                    { name: '样本集合', url: 'https://cache.industry.siemens.com/dl/dl-media/725/109988725/att_1328897/v1/191323107851_zh-CHS/zh-CHS/index.html#legalinfo' }
                ],
                'unified-basic': [
                    { name: 'WinCC Unified 入门指南', url: 'https://support.industry.siemens.com/dl/dl-media/244/109954244/att_1263983/v1/177545453067_zh-CHS/zh-CHS/index.html#treeId=f637aa78ec078a476b3ad61d90d48b04' },
                    { name: '样本集合', url: 'https://cache.industry.siemens.com/dl/dl-media/725/109988725/att_1328897/v1/191323107851_zh-CHS/zh-CHS/index.html#legalinfo' }
                ],
                'comfort': [
                    { name: '精智面板/移动面板/精简面板 映像下载', url: 'https://support.industry.siemens.com/cs/document/109825750/simatic-hmi-%E6%93%8D%E4%BD%9C%E9%9D%A2%E6%9D%BF%E7%9A%84%E6%98%A0%E5%83%8F%E4%B8%8B%E8%BD%BD%EF%BC%9A%E7%B2%BE%E6%99%BA%E9%9D%A2%E6%9D%BF-%E7%A7%BB%E5%8A%A8%E9%9D%A2%E6%9D%BF-%E7%B2%BE%E7%AE%80%E9%9D%A2%E6%9D%BF?dti=0&lc=zh-CN' },
                    { name: 'SIMATIC HMI 精智面板 TP1500/KP1500', url: 'https://support.industry.siemens.com/cs/document/109822224/simatic-hmi-%E7%B2%BE%E6%99%BA%E9%9D%A2%E6%9D%BF-tp1500-kp1500-comfort-v2-1?dti=0&lc=zh-CN' },
                    { name: '精智面板合集', url: 'https://support.industry.siemens.com/dl/dl-media/233/49313233/att_1069145/v3/158409845259_zh-CHS/zh-CHS/index.html' },
                    { name: '精智面板样本', url: 'https://support.industry.siemens.com/cs/document/49313233/simatic-hmi-%E6%93%8D%E4%BD%9C%E8%AE%BE%E5%A4%87-%E7%B2%BE%E6%99%BA%E9%9D%A2%E6%9D%BF?dti=0&lc=zh-CN' }
                ],
                'basic': [
                    { name: '精智面板/移动面板/精简面板 映像下载', url: 'https://support.industry.siemens.com/cs/document/109825750/simatic-hmi-%E6%93%8D%E4%BD%9C%E9%9D%A2%E6%9D%BF%E7%9A%84%E6%98%A0%E5%83%8F%E4%B8%8B%E8%BD%BD%EF%BC%9A%E7%B2%BE%E6%99%BA%E9%9D%A2%E6%9D%BF-%E7%A7%BB%E5%8A%A8%E9%9D%A2%E6%9D%BF-%E7%B2%BE%E7%AE%80%E9%9D%A2%E6%9D%BF?dti=0&lc=zh-CN' },
                    { name: '精简系列样本 (1)', url: 'https://cache.industry.siemens.com/dl/dl-media/350/90114350/att_1311898/v1/188429840651_zh-CHS/zh-CHS/index.html' },
                    { name: '精简系列样本 (2)', url: 'https://support.industry.siemens.com/cs/document/90114350/simatic-hmi-%E6%93%8D%E4%BD%9C%E8%AE%BE%E5%A4%87-%E7%AC%AC%E4%BA%8C%E4%BB%A3%E7%B2%BE%E7%AE%80%E7%B3%BB%E5%88%97%E9%9D%A2%E6%9D%BF?dti=0&lc=zh-CN' }
                ],
                'smart-line-plus': [
                    { name: '官网合集', url: 'https://w2.siemens.com.cn/smart/Product/HMI' },
                    { name: 'HMI Smart Plus panel and SMART panel V5 Operating Instructions_zh-CN_zh-CN', url: 'https://support.industry.siemens.com/cs/document/109826277' },
                    { name: 'SMART LINE Assistant 自述文件', url: 'https://support.industry.siemens.com/cs/document/109817296' }
                ],
                'smart-line': [
                    { name: 'SMART Line Assistant 自述文件', url: 'https://support.industry.siemens.com/cs/document/109978418/smart-line-assistant-%E8%87%AA%E8%BF%B0%E6%96%87%E4%BB%B6%E2%80%9D?dti=0&lc=zh-CN' },
                    { name: 'HMI 设备 Smart 700/1000 IE V5', url: 'https://support.industry.siemens.com/cs/document/109978413/simatic-hmi-hmi-%E8%AE%BE%E5%A4%87-smart-700-ie-v5-smart-1000-ie-v5?dti=0&lc=zh-CN' },
                    { name: 'Smart 700/1000 IE V5 快速安装向导', url: 'https://support.industry.siemens.com/cs/document/109989737/smart-700-ie-v5-smart-1000-ie-v5-quick-install-guide?dti=0&lc=zh-CN' },
                    { name: '精彩面板（ SMART LINE ）合集', url: 'https://support.industry.siemens.com/cs/document/109828404/-%E7%B2%BE%E5%BD%A9%E9%9D%A2%E6%9D%BF%EF%BC%88-smart-line-%EF%BC%89%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E5%90%88%E9%9B%86?dti=0&lc=zh-CN' }
                ],
                'ipc': [{ name: 'SIMATIC IPC377G合集', url: 'https://cache.industry.siemens.com/dl/dl-media/084/109806084/att_1092918/v3/ipc377g_operating_instructions_zh-CHS/zh-CHS/index.html#treeId=69378e016978d598420563bdb424db30' }],
                'ifp': [
                    { name: 'SIMATIC IFP Basic', url: 'https://support.industry.siemens.com/cs/document/109767074/simatic-ifp-basic-%E4%BE%9B%E8%B4%A7%E5%8F%91%E5%B8%83?dti=0&lc=zh-CN' },
                    { name: 'SIMATIC IFP 合集', url: 'https://cache.industry.siemens.com/dl/dl-media/495/109767495/att_1136750/v1/166920504971_zh-CHS/zh-CHS/index.html#treeId=3937d4e615721d65d3f8c9e06dfd7da6' }
                ]
            };

            const softwareLicenseData = [
                { feature: '目标设备', basic: 'Basic Panels', comfort: 'Comfort / Mobile / Basic Panels', advanced: 'Comfort / Mobile / Basic / PC Runtime', unified: 'Unified Comfort / PC Runtime' },
                { feature: '脚本支持', basic: '<span class="software-table-cross">✗</span>', comfort: 'VBScript', advanced: 'VBScript, C-Script', unified: 'JavaScript' },
                { feature: '配方数量', basic: '50', comfort: '300', advanced: '1000', unified: '无限制 (受设备内存影响)' },
                { feature: '归档功能', basic: '有限 (U盘)', comfort: '<span class="software-table-check">✓</span>', advanced: '<span class="software-table-check">✓</span> (数据库)', unified: '<span class="software-table-check">✓</span> (数据库)' },
                { feature: 'Web客户端', basic: '<span class="software-table-cross">✗</span>', comfort: 'Sm@rtServer (镜像)', advanced: 'WebNavigator (需授权)', unified: '标配 (独立会话)' },
                { feature: '面板 (Faceplates)', basic: '<span class="software-table-cross">✗</span>', comfort: '<span class="software-table-check">✓</span>', advanced: '<span class="software-table-check">✓</span>', unified: '<span class="software-table-check">✓</span>' },
                { feature: '参考订货号', basic: '6AV2100-0AA00-0AA5', comfort: '6AV2101-0AA07-0AA5', advanced: '6AV2102-0AA07-0AA5', unified: '6AV2110-....' },
            ];
            
            let compareList = [];
            let wizardAnswers = {};

            function createPriceRows(itemData, targetBody) {
                 let rowsHtml = '';
                 itemData.forEach(item => {
                    let modelsHtml = '';
                    item.models.forEach(model => {
                        const description = model.desc ? `<span class="font-semibold text-gray-600">${model.desc}</span>` : '';
                        
                        let discountPriceHtml;
                        if (model.price.includes('洽询')) {
                            discountPriceHtml = '洽询';
                        } else {
                            const listPrice = parseFloat(model.price.replace(/[^0-9.]/g, ''));
                            const discountPrice = (listPrice * 0.47).toFixed(2);
                            discountPriceHtml = `¥ ${new Intl.NumberFormat('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2}).format(discountPrice)}`;
                        }

                        modelsHtml += `
                            <div class="grid grid-cols-12 gap-x-4 items-center py-1.5 border-b border-gray-100 last:border-b-0">
                                <div class="col-span-12 md:col-span-5">
                                    ${description}
                                    <code class="text-blue-600 font-mono ml-2">${model.number}</code>
                                </div>
                                <div class="col-span-6 md:col-span-2 font-semibold text-red-500 text-left md:text-right">${model.price}</div>
                                <div class="col-span-6 md:col-span-2 font-semibold text-green-600 text-left md:text-right">${discountPriceHtml}</div>
                                <div class="col-span-12 md:col-span-3 flex justify-end items-center gap-2">
                                    <button class="compare-btn text-xs" data-number="${model.number}" title="加入对比">${compareList.includes(model.number) ? '✓ 已添加' : '加入对比'}</button>
                                    <button class="copy-btn" data-number="${model.number}" title="复制订货号">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                          <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                          <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                                        </svg>
                                    </button>
                                </div>
                            </div>`;
                    });

                    rowsHtml += `
                        <tr class="order-row border-t border-gray-200" data-size="${item.size}">
                            <td class="font-semibold">${item.size}</td>
                            <td>
                                <div class="hidden md:grid grid-cols-12 gap-x-4 text-xs font-bold text-gray-500 mb-1">
                                    <div class="md:col-span-5">型号描述 / 订货号</div>
                                    <div class="md:col-span-2 text-right">RMB列表价</div>
                                    <div class="md:col-span-2 text-right">参考折扣价</div>
                                    <div class="md:col-span-3"></div>
                                </div>
                                <div class="space-y-1">${modelsHtml}</div>
                            </td>
                        </tr>
                    `;
                });
                targetBody.innerHTML = rowsHtml;
            }
            
            function populateAllData() {
                for (const seriesId in productData) {
                    const product = productData[seriesId];
                    const mainBody = document.querySelector(`#${seriesId} .order-number-body`);
                    const accBody = document.querySelector(`#${seriesId} .accessories-body`);

                    if (mainBody && product.main) {
                        createPriceRows(product.main, mainBody);
                    }
                    if (accBody && product.accessories && product.accessories.length > 0) {
                        const headerRow = `
                            <tr class="sub-header-row">
                                <th colspan="2">常用附件与备件</th>
                            </tr>
                        `;
                        accBody.innerHTML = headerRow;
                        createPriceRows(product.accessories, accBody);
                    }
                    
                    const docCell = document.querySelector(`#${seriesId} [data-param="doc-links"] td:last-child`);
                    if(docCell && docLinks[seriesId]) {
                        docCell.innerHTML = docLinks[seriesId]
                            .map((link, index) => `<a href="${link.url}" target="_blank" class="doc-link inline-block mr-6 mb-1">${index + 1}. ${link.name}</a>`)
                            .join('');
                    }
                }

                const softwareBody = document.getElementById('software-license-body');
                if (softwareBody) {
                    let softwareHtml = '';
                    softwareLicenseData.forEach(row => {
                         softwareHtml += `
                            <tr class="border-b">
                                <td class="software-table-feature-col text-left p-3">${row.feature}</td>
                                <td class="p-3">${row.basic}</td>
                                <td class="p-3">${row.comfort}</td>
                                <td class="p-3">${row.advanced}</td>
                                <td class="p-3">${row.unified}</td>
                            </tr>
                         `;
                    });
                    softwareBody.innerHTML = softwareHtml;
                }
            }
            
            populateAllData();

            const tabButtonsContainer = document.getElementById('tab-buttons');
            const tabContentsContainer = document.getElementById('tab-contents');
            
            if(tabButtonsContainer) {
                tabButtonsContainer.addEventListener('click', function(event){
                    const button = event.target.closest('.tab-button');
                    if(!button) return;
                    
                    document.querySelector('.tab-button.active').classList.remove('active');
                    button.classList.add('active');

                    document.querySelector('.tab-content.active').classList.remove('active');
                    document.getElementById(button.dataset.tab).classList.add('active');
                });
            }
            
            // --- Filter Logic ---
            const filterControls = document.querySelectorAll('.filter-control');
            filterControls.forEach(control => control.addEventListener('change', applyFilters));
            document.getElementById('reset-filters').addEventListener('click', () => {
                filterControls.forEach(control => control.value = 'all');
                applyFilters();
            });

            function applyFilters() {
                const touchFilter = document.getElementById('filter-touch').value;
                const scriptFilter = document.getElementById('filter-script').value;
                const interfaceFilter = document.getElementById('filter-interface').value;
                
                document.querySelectorAll('.tab-content').forEach(tab => {
                    const tabId = tab.id;
                    if (tabId === 'software') return;

                    const touchMatch = (touchFilter === 'all' || tab.dataset.touch === touchFilter);
                    const scriptMatch = (scriptFilter === 'all' || tab.dataset.script === scriptFilter || (scriptFilter === 'all' && tab.dataset.script === 'all'));
                    const interfaceMatch = (interfaceFilter === 'all' || tab.dataset.interface.includes(interfaceFilter));

                    const isMatch = touchMatch && scriptMatch && interfaceMatch;
                    
                    const tabButton = document.querySelector(`.tab-button[data-tab="${tabId}"]`);
                    if (isMatch) {
                        tab.classList.remove('filtered-out');
                        tabButton.classList.remove('filtered-out');
                    } else {
                        tab.classList.add('filtered-out');
                        tabButton.classList.add('filtered-out');
                    }
                });

                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab && activeTab.classList.contains('filtered-out')) {
                    const firstVisibleTab = document.querySelector('.tab-content:not(.filtered-out)');
                    if (firstVisibleTab) {
                        const firstVisibleTabId = firstVisibleTab.id;
                        document.querySelector('.tab-button.active').classList.remove('active');
                        document.querySelector(`.tab-button[data-tab="${firstVisibleTabId}"]`).classList.add('active');
                        activeTab.classList.remove('active');
                        firstVisibleTab.classList.add('active');
                    }
                }
            }


            // --- Compare Logic ---
            const compareSidebar = document.getElementById('compare-sidebar');
            const compareListDiv = document.getElementById('compare-list');
            const compareCountSpan = document.getElementById('compare-count');
            const startCompareBtn = document.getElementById('start-compare-btn');
            const clearCompareBtn = document.getElementById('clear-compare-btn');
            const compareModal = document.getElementById('compare-modal');
            const closeCompareModalBtn = document.getElementById('close-compare-modal');

            function updateCompareUI() {
                compareCountSpan.textContent = compareList.length;
                compareListDiv.innerHTML = '';
                if (compareList.length === 0) {
                    compareListDiv.innerHTML = '<p class="text-gray-500 text-sm">请从表格中添加产品进行对比。</p>';
                    compareSidebar.classList.remove('visible');
                    document.getElementById('page-wrapper').style.marginRight = '0';
                    startCompareBtn.disabled = true;
                } else {
                    compareSidebar.classList.add('visible');
                     document.getElementById('page-wrapper').style.marginRight = '350px';
                    startCompareBtn.disabled = false;
                    compareList.forEach(itemNumber => {
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'flex justify-between items-center bg-gray-100 p-2 rounded';
                        
                        let itemName = '未知产品';
                        for(const series in productData){
                            for(const group of [...productData[series].main, ...(productData[series].accessories || [])]){
                                const foundModel = group.models.find(m => m.number === itemNumber);
                                if(foundModel){
                                    itemName = `${foundModel.desc || group.size} - ${itemNumber}`;
                                    break;
                                }
                            }
                        }

                        itemDiv.innerHTML = `<span class="text-sm flex-grow">${itemName}</span><button class="remove-from-compare text-red-500 p-1" data-number="${itemNumber}">&times;</button>`;
                        compareListDiv.appendChild(itemDiv);
                    });
                }
                
                document.querySelectorAll('.compare-btn').forEach(btn => {
                    const btnNumber = btn.dataset.number;
                    if (compareList.includes(btnNumber)) {
                        btn.classList.add('added');
                        btn.innerHTML = '✓ 已添加';
                        btn.disabled = false;
                    } else {
                        btn.classList.remove('added');
                        btn.innerHTML = '加入对比';
                        btn.disabled = compareList.length >= 4;
                    }
                });
            }

            tabContentsContainer.addEventListener('click', function(event) {
                const copyBtn = event.target.closest('.copy-btn');
                if (copyBtn) {
                    event.stopPropagation();
                    const textToCopy = copyBtn.dataset.number;
                    navigator.clipboard.writeText(textToCopy).then(() => {
                        const originalContent = copyBtn.innerHTML;
                        copyBtn.innerHTML = `<span class="text-sm text-green-600">已复制!</span>`;
                        copyBtn.disabled = true;
                        setTimeout(() => {
                            copyBtn.innerHTML = originalContent;
                            copyBtn.disabled = false;
                        }, 1500);
                    });
                    return;
                }

                const compareBtn = event.target.closest('.compare-btn');
                if (compareBtn) {
                    event.stopPropagation();
                    const number = compareBtn.dataset.number;
                    const index = compareList.indexOf(number);

                    if (index > -1) {
                        compareList.splice(index, 1);
                    } else {
                        if (compareList.length < 4) {
                            compareList.push(number);
                        } else {
                            alert('最多只能对比4个产品。');
                        }
                    }
                    updateCompareUI();
                }
            });
            
            compareListDiv.addEventListener('click', function(event){
                const removeBtn = event.target.closest('.remove-from-compare');
                if(removeBtn){
                    const number = removeBtn.dataset.number;
                    const index = compareList.indexOf(number);
                    if(index > -1) {
                        compareList.splice(index, 1);
                        updateCompareUI();
                    }
                }
            });

            clearCompareBtn.addEventListener('click', () => {
                compareList = [];
                updateCompareUI();
            });
            
            startCompareBtn.addEventListener('click', () => {
                generateCompareTable();
                compareModal.classList.add('visible');
            });
            
            closeCompareModalBtn.addEventListener('click', () => {
                compareModal.classList.remove('visible');
            });
            
            function findProductByNumber(number) {
                 for (const seriesId in productData) {
                    for (const group of [...productData[seriesId].main, ...(productData[seriesId].accessories || [])]) {
                        const model = group.models.find(m => m.number === number);
                        if(model) {
                            const seriesName = document.querySelector(`#${seriesId} h3`).textContent.split('-')[0].trim();
                            return {...model, series: seriesName, size: group.size, seriesId: seriesId};
                        }
                    }
                }
                return null;
            }

            function generateCompareTable(){
                const container = document.getElementById('compare-table-container');
                const productsToCompare = compareList.map(findProductByNumber).filter(p => p);
                
                if(productsToCompare.length === 0) {
                    container.innerHTML = '<p>没有可对比的产品。</p>';
                    return;
                }
                
                const allParams = [ '系列', '型号', '订货号', 'RMB列表价', '参考折扣价', '目标应用', '触摸技术', '处理器架构', 'PROFINET接口', '串行接口', 'USB 接口', '核心优势' ];
                
                let tableHtml = '<table class="w-full text-sm text-left"><thead><tr><th class="w-1/5">特性</th>';
                productsToCompare.forEach(p => {
                    tableHtml += `<th class="text-center p-2">${p.desc || p.size}<br><span class="text-xs font-normal text-gray-500">${p.series}</span></th>`;
                });
                tableHtml += '</tr></thead><tbody>';
                
                const productDetails = {};
                productsToCompare.forEach((p, i) => {
                     const tab = document.getElementById(p.seriesId);
                     productDetails[i] = {};
                     allParams.forEach(param => {
                         let value = '-';
                         switch(param) {
                             case '系列': value = p.series; break;
                             case '型号': value = p.desc || p.size; break;
                             case '订货号': value = `<code class="text-xs">${p.number}</code>`; break;
                             case 'RMB列表价': value = p.price; break;
                             case '参考折扣价': value = p.price.includes('洽询') ? '洽询' : `¥ ${(parseFloat(p.price.replace(/[^0-9.]/g, ''))*0.47).toFixed(2)}`; break;
                             default:
                                const row = Array.from(tab.querySelectorAll('tr.order-row')).find(r => r.cells[0] && r.cells[0].textContent.includes(param));
                                if(row && row.cells[1]) value = row.cells[1].innerHTML;
                         }
                         productDetails[i][param] = value;
                     });
                });

                allParams.forEach(param => {
                    tableHtml += `<tr class="border-b"><td class="font-semibold bg-gray-50 p-3">${param}</td>`;
                    productsToCompare.forEach((p, i) => {
                        tableHtml += `<td class="p-3 align-top">${productDetails[i][param] || '-'}</td>`;
                    });
                    tableHtml += '</tr>';
                });

                tableHtml += '</tbody></table>';
                container.innerHTML = tableHtml;
            }

            // Radar Chart
            const radarCtx = document.getElementById('performanceRadarChart').getContext('2d');
            new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: ['性能', '连接性', '开放性', '成本效益', '现代化'],
                    datasets: [
                        { label: '精简(Basic)', data: [1, 2, 1, 5, 1], fill: true, backgroundColor: 'rgba(255, 193, 7, 0.2)', borderColor: 'rgb(255, 193, 7)', pointBackgroundColor: 'rgb(255, 193, 7)'},
                        { label: '精智(Comfort)', data: [3, 4, 2, 3, 2], fill: true, backgroundColor: 'rgba(255, 159, 64, 0.2)', borderColor: 'rgb(255, 159, 64)', pointBackgroundColor: 'rgb(255, 159, 64)'},
                        { label: '精彩(Smart)', data: [2, 3, 3, 4, 3], fill: true, backgroundColor: 'rgba(54, 162, 235, 0.2)', borderColor: 'rgb(54, 162, 235)', pointBackgroundColor: 'rgb(54, 162, 235)'},
                        { label: '精智统一基础(UB)', data: [3, 3, 4, 4, 4], fill: true, backgroundColor: 'rgba(75, 192, 192, 0.2)', borderColor: 'rgb(75, 192, 192)', pointBackgroundColor: 'rgb(75, 192, 192)'},
                        { label: '精智统一(UC)', data: [5, 5, 5, 2, 5], fill: true, backgroundColor: 'rgba(40, 167, 69, 0.2)', borderColor: 'rgb(40, 167, 69)', pointBackgroundColor: 'rgb(40, 167, 69)'}
                    ]
                },
                options: {
                    maintainAspectRatio: false,
                    elements: { line: { tension: 0.1 } },
                    scales: { r: { angleLines: { display: true }, suggestedMin: 0, suggestedMax: 5, pointLabels: { font: { size: 14 } } } },
                    plugins: { legend: { position: 'bottom' } }
                }
            });
            
            // --- Highlight Wizard Logic ---
            const highlightWizardBtns = document.getElementById('highlight-wizard-buttons');
            const highlightWizardResults = document.getElementById('highlight-wizard-results');
            const highlightPrompt = document.getElementById('highlight-prompt');

            const highlightData = {
                tech: [
                    { name: '精智统一 (Unified Comfort)', desc: '<span class="highlight-text">旗舰性能</span> - 集成边缘计算、多点触控、JS脚本，为数字化和IT/OT融合而生。', tab: 'unified-comfort' },
                    { name: '精智统一基础 (Unified Basic)', desc: '<span class="highlight-text">现代入门</span> - 将多点触控、JS脚本等现代技术带给基础应用，性价比高。', tab: 'unified-basic' }
                ],
                cost: [
                    { name: '精彩增强 (Smart Line Plus)', desc: '<span class="highlight-text">博途性价比</span> - 以Smart Line价格连接S7-1200/1500，TIA项目优选。', tab: 'smart-line-plus' },
                    { name: '精彩系列 (Smart Line)', desc: '<span class="highlight-text">200SMART绝配</span> - 专为S7-200 SMART配套，成本优化到极致。', tab: 'smart-line' },
                ],
                stable: [
                    { name: '精智系列 (Comfort)', desc: '<span class="highlight-text">成熟标杆</span> - 支持VBScript和DP总线，是旧项目维护和备件替换的首选。', tab: 'comfort' },
                    { name: '精简系列 (Basic)', desc: '<span class="highlight-text">经济可靠</span> - 功能基础，价格最低，适用于最简单的标准任务。', tab: 'basic' }
                ],
                pc: [
                    { name: '工控机 (Panel PC)', desc: '<span class="highlight-text">一体化PC</span> - 将HMI与Windows PC合二为一，开放、紧凑、功能强大。', tab: 'ipc' },
                    { name: '工业显示器 (IFP)', desc: '<span class="highlight-text">分布式架构</span> - 仅作显示单元，与独立IPC配合，架构灵活。', tab: 'ifp' }
                ]
            };

            highlightWizardBtns.addEventListener('click', function(e) {
                const button = e.target.closest('.highlight-wizard-btn');
                if (!button) return;

                // Update button styles
                this.querySelectorAll('.highlight-wizard-btn').forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                
                // Hide prompt and show results
                highlightPrompt.style.display = 'none';
                const targetData = highlightData[button.dataset.target];
                let resultsHtml = '';

                targetData.forEach(item => {
                    resultsHtml += `
                        <div class="highlight-result show">
                            <div class="flex justify-between items-start">
                                <div class="flex-grow">
                                    <h4 class="font-bold">${item.name}</h4>
                                    <p class="text-gray-600">${item.desc}</p>
                                </div>
                                <a href="#${item.tab}" data-tab-link="${item.tab}" class="view-details-link ml-2 flex-shrink-0 text-xs bg-blue-500 text-white py-1 px-2 rounded hover:bg-blue-600">查看详情</a>
                            </div>
                        </div>
                    `;
                });
                highlightWizardResults.innerHTML = resultsHtml;
            });

            highlightWizardResults.addEventListener('click', function(e){
                const link = e.target.closest('.view-details-link');
                if(!link) return;
                e.preventDefault();
                const targetTabId = link.dataset.tabLink;

                // Activate the corresponding tab
                document.querySelector('.tab-button.active').classList.remove('active');
                const newActiveButton = document.querySelector(`.tab-button[data-tab="${targetTabId}"]`);
                newActiveButton.classList.add('active');
                
                document.querySelector('.tab-content.active').classList.remove('active');
                document.getElementById(targetTabId).classList.add('active');

                // Scroll to the tabs section
                document.getElementById('series-tabs').scrollIntoView({ behavior: 'smooth', block: 'start' });
            });


            // --- Main Wizard Logic (Modal) ---
            const wizardModal = document.getElementById('wizard-modal');
            const openWizardBtn = document.getElementById('open-wizard-btn');
            const closeWizardBtn = document.getElementById('close-wizard-modal');
            const wizardSteps = document.querySelectorAll('.wizard-step');
            const wizardPrevBtn = document.getElementById('wizard-prev');
            const wizardNextBtn = document.getElementById('wizard-next');
            const wizardRecommendation = document.getElementById('wizard-recommendation');
            const wizardViewResultBtn = document.getElementById('wizard-view-result');
            let currentStep = 1;

            function updateWizardButtons() {
                wizardPrevBtn.disabled = currentStep === 1;
                const currentStepDiv = document.getElementById(`wizard-step-${currentStep}`);
                if (currentStepDiv.querySelector('.wizard-option.selected')) {
                    wizardNextBtn.disabled = false;
                } else {
                    wizardNextBtn.disabled = true;
                }
            }

            function goToStep(step) {
                document.querySelector('.wizard-step.active').classList.remove('active');
                document.getElementById(`wizard-step-${step}`).classList.add('active');
                currentStep = step;
                updateWizardButtons();
            }
            
            openWizardBtn.addEventListener('click', () => wizardModal.classList.add('visible'));
            closeWizardBtn.addEventListener('click', () => wizardModal.classList.remove('visible'));
            
            wizardPrevBtn.addEventListener('click', () => {
                if (currentStep > 1) goToStep(currentStep - 1);
            });
            
            wizardNextBtn.addEventListener('click', () => {
                const selectedOption = document.querySelector(`#wizard-step-${currentStep} .wizard-option.selected`);
                if(selectedOption){
                    wizardAnswers[`q${currentStep}`] = selectedOption.dataset.value;
                    processWizard();
                }
            });

            document.querySelectorAll('.wizard-option').forEach(option => {
                option.addEventListener('click', (e) => {
                    const parent = e.currentTarget.parentElement;
                    parent.querySelectorAll('.wizard-option').forEach(opt => opt.classList.remove('selected'));
                    e.currentTarget.classList.add('selected');
                    updateWizardButtons();
                });
            });
            
            function processWizard() {
                 const q1 = wizardAnswers.q1;
                 const q2 = wizardAnswers.q2;
                 const q3 = wizardAnswers.q3;

                if (q1 === 'smart' || q1 === 'pc') {
                     let resultTab = q1 === 'smart' ? 'smart-line' : 'ipc';
                     let resultText = q1 === 'smart' ? '精彩系列面板 (Smart Line)' : '工控机 (Panel PC)';
                     wizardRecommendation.textContent = resultText;
                     wizardViewResultBtn.dataset.targetTab = resultTab;
                     goToStep(4);
                     return;
                }
                
                if(!q2) {
                    goToStep(2);
                    return;
                }

                if (!q3) {
                     goToStep(3);
                     return;
                }

                let resultTab = '';
                let resultText = '';

                if (q2 === 'simple') {
                    resultTab = q3 === 'cost' ? 'basic' : 'unified-basic';
                    resultText = q3 === 'cost' ? '精简系列面板 (Basic)' : '精智统一基础面板 (Unified Basic)';
                } else { // complex
                    resultTab = q3 === 'cost' ? 'comfort' : 'unified-comfort';
                    resultText = q3 === 'cost' ? '精智系列面板 (Comfort)' : '精智统一舒适型面板 (Unified Comfort)';
                }
                
                wizardRecommendation.textContent = resultText;
                wizardViewResultBtn.dataset.targetTab = resultTab;
                goToStep(4);
            }

            wizardViewResultBtn.addEventListener('click', function(){
                const targetTab = this.dataset.targetTab;
                if(targetTab) {
                    document.querySelector('.tab-button.active').classList.remove('active');
                    document.querySelector('.tab-content.active').classList.remove('active');

                    document.querySelector(`.tab-button[data-tab="${targetTab}"]`).classList.add('active');
                    document.getElementById(targetTab).classList.add('active');
                    wizardModal.classList.remove('visible');

                    // Reset wizard for next time
                    goToStep(1);
                    document.querySelectorAll('.wizard-option.selected').forEach(el => el.classList.remove('selected'));
                    wizardAnswers = {};
                }
            });


        });
    </script>
</body>
</html>
